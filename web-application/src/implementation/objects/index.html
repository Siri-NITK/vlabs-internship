<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2016-06-03 Fri 09:27 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="viewport" content="width=device-width, initial-scale=1" />
<title>Object  Implementation of Mini Version of User Directory Application</title>
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="VLEAD" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Object  Implementation of Mini Version of User Directory Application</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgheadline4">1. Initialization</a>
<ul>
<li><a href="#orgheadline1">1.1. Imports for Python API</a></li>
<li><a href="#orgheadline2">1.2. Imports and Initialization of testcases for Python API</a></li>
<li><a href="#orgheadline3">1.3. Init Files</a></li>
</ul>
</li>
<li><a href="#orgheadline5">2. Object Model</a></li>
<li><a href="#orgheadline83">3. Custom Exceptions</a>
<ul>
<li>
<ul>
<li><a href="#orgheadline6">3.0.1. AttributeRequired</a></li>
</ul>
</li>
<li><a href="#orgheadline9">3.1. Name</a>
<ul>
<li><a href="#orgheadline7">3.1.1. Construction</a></li>
<li><a href="#orgheadline8">3.1.2. Test the Construction</a></li>
</ul>
</li>
<li><a href="#orgheadline12">3.2. Email</a>
<ul>
<li><a href="#orgheadline10">3.2.1. Construction</a></li>
<li><a href="#orgheadline11">3.2.2. Test the Construction</a></li>
</ul>
</li>
<li><a href="#orgheadline30">3.3. User</a>
<ul>
<li><a href="#orgheadline13">3.3.1. Mutable Data</a></li>
<li><a href="#orgheadline14">3.3.2. Definition</a></li>
<li><a href="#orgheadline17">3.3.3. Constructor</a></li>
<li><a href="#orgheadline29">3.3.4. Functions</a></li>
</ul>
</li>
<li><a href="#orgheadline44">3.4. Role</a>
<ul>
<li><a href="#orgheadline31">3.4.1. Introduction</a></li>
<li><a href="#orgheadline32">3.4.2. Mutable Data</a></li>
<li><a href="#orgheadline33">3.4.3. Definition</a></li>
<li><a href="#orgheadline34">3.4.4. Constructor</a></li>
<li><a href="#orgheadline35">3.4.5. Test Constructor</a></li>
<li><a href="#orgheadline43">3.4.6. Functions</a></li>
</ul>
</li>
<li><a href="#orgheadline52">3.5. Session</a>
<ul>
<li><a href="#orgheadline45">3.5.1. Introduction</a></li>
<li><a href="#orgheadline46">3.5.2. Mutable Data</a></li>
<li><a href="#orgheadline47">3.5.3. Definition</a></li>
<li><a href="#orgheadline48">3.5.4. Constructor</a></li>
<li><a href="#orgheadline51">3.5.5. Functions</a></li>
</ul>
</li>
<li><a href="#orgheadline81">3.6. WebSystem</a>
<ul>
<li><a href="#orgheadline53">3.6.1. Introduction</a></li>
<li><a href="#orgheadline54">3.6.2. Mutable Data</a></li>
<li><a href="#orgheadline55">3.6.3. Definition</a></li>
<li><a href="#orgheadline56">3.6.4. Constructor</a></li>
<li><a href="#orgheadline57">3.6.5. Test Constructor</a></li>
<li><a href="#orgheadline80">3.6.6. Functions</a></li>
</ul>
</li>
<li><a href="#orgheadline82">3.7. setUp and tearDown</a></li>
</ul>
</li>
<li><a href="#orgheadline84">4. Run Test Cases</a></li>
</ul>
</div>
</div>


<div id="outline-container-orgheadline4" class="outline-2">
<h2 id="orgheadline4"><span class="section-number-2">1</span> Initialization</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-orgheadline1" class="outline-3">
<h3 id="orgheadline1"><span class="section-number-3">1.1</span> Imports for Python API</h3>
<div class="outline-text-3" id="text-1-1">
<div class="org-src-container">

<pre class="src src-python"># -*- coding: utf-8 -*-
from op_exceptions import AttributeRequired
from op_exceptions import NotAuthorizedError
from op_exceptions import ConstraintError
from utils import *
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline2" class="outline-3">
<h3 id="orgheadline2"><span class="section-number-3">1.2</span> Imports and Initialization of testcases for Python API</h3>
<div class="outline-text-3" id="text-1-2">
<div class="org-src-container">

<pre class="src src-python"># -*- coding: utf-8 -*-
import unittest
from unittest import TestCase
from datetime import datetime

from src.obj import *
from src.op_exceptions import AttributeRequired
from src.op_exceptions import NotAuthorizedError
from src.op_exceptions import ConstraintError
</pre>
</div>
</div>
</div>



<div id="outline-container-orgheadline3" class="outline-3">
<h3 id="orgheadline3"><span class="section-number-3">1.3</span> Init Files</h3>
<div class="outline-text-3" id="text-1-3">
<div class="org-src-container">

<pre class="src src-python">import obj
</pre>
</div>

<div class="org-src-container">

<pre class="src src-python">print "tests package"
</pre>
</div>
</div>
</div>
</div>



<div id="outline-container-orgheadline5" class="outline-2">
<h2 id="orgheadline5"><span class="section-number-2">2</span> Object Model</h2>
</div>
<div id="outline-container-orgheadline83" class="outline-2">
<h2 id="orgheadline83"><span class="section-number-2">3</span> Custom Exceptions</h2>
<div class="outline-text-2" id="text-3">
<p>
These are some of the custom exceptions used in the application.
</p>
</div>

<div id="outline-container-orgheadline6" class="outline-4">
<h4 id="orgheadline6"><span class="section-number-4">3.0.1</span> AttributeRequired</h4>
<div class="outline-text-4" id="text-3-0-1">
<div class="org-src-container">

<pre class="src src-python">class AttributeRequired(Exception):
    str = None

    def __init__(self, str):
        self.str = str

    def __str__(self):
        return repr(self.str)

class NotAuthorizedError(Exception):
    str = None

    def __init__(self, str):
        self.str = str

    def __str__(self):
        return repr(self.str)
        
class ConstraintError(Exception):
    str = None

    def __init__(self, str):
        self.str = str

    def __str__(self):
        return repr(self.str)
</pre>
</div>
</div>
</div>






<div id="outline-container-orgheadline9" class="outline-3">
<h3 id="orgheadline9"><span class="section-number-3">3.1</span> Name</h3>
<div class="outline-text-3" id="text-3-1">
</div><div id="outline-container-orgheadline7" class="outline-4">
<h4 id="orgheadline7"><span class="section-number-4">3.1.1</span> Construction</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
Name is an alphabetical string.
</p>

<div class="org-src-container">

<pre class="src src-python">class Name(object):
    value = None
    def __init__(self, value):
        # value: String 
        # if the string contains any non-alphabet and non-space character,
        # raise a type error
        if is_alphabetic_string(value):
            self.value = value
        else:
            raise TypeError('%s is not a Name!' % value)

    def __str__(self):
        return self.value
        
    def to_client(self):
        return self.value
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline8" class="outline-4">
<h4 id="orgheadline8"><span class="section-number-4">3.1.2</span> Test the Construction</h4>
<div class="outline-text-4" id="text-3-1-2">
<div class="org-src-container">

<pre class="src src-python">class TestName(TestCase):
    TESTING = True
    

    def test_name_type(self):
        print "test_name_type"
        new_name = Name("John")
        # correct name
        self.assertEqual(new_name.value, "John")
        # incorrect name
        self.assertRaises(TypeError, Name, "123dasd")
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orgheadline12" class="outline-3">
<h3 id="orgheadline12"><span class="section-number-3">3.2</span> Email</h3>
<div class="outline-text-3" id="text-3-2">
</div><div id="outline-container-orgheadline10" class="outline-4">
<h4 id="orgheadline10"><span class="section-number-4">3.2.1</span> Construction</h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
Email is a type as defined in RFC <a href="https://tools.ietf.org/html/rfc5321">5321</a>, <a href="https://tools.ietf.org/html/rfc5322">5322</a> and <a href="https://tools.ietf.org/html/rfc6531">6531</a>.
Following is the constructor for this class.
</p>

<div class="org-src-container">

<pre class="src src-python">class Email(object):
    value = None
    def __init__(self, value):
        if is_email(value):
            self.value = value
        else:
            raise TypeError('%s is not a valid Email!' %value)
            
    def __str__(self):
        return self.value
        
    def to_client(self):
        return self.value
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline11" class="outline-4">
<h4 id="orgheadline11"><span class="section-number-4">3.2.2</span> Test the Construction</h4>
<div class="outline-text-4" id="text-3-2-2">
<div class="org-src-container">

<pre class="src src-python">class TestEmail(TestCase):
    TESTING = True
    

    def test_email_type(self):
        print "test_email_type"
        new_email = Email("John@gmail.com")
        # correct email
        self.assertEqual(new_email.value, "John@gmail.com")
        # incorrect email
        self.assertRaises(TypeError,Email,"John")
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgheadline30" class="outline-3">
<h3 id="orgheadline30"><span class="section-number-3">3.3</span> User</h3>
<div class="outline-text-3" id="text-3-3">
</div><div id="outline-container-orgheadline13" class="outline-4">
<h4 id="orgheadline13"><span class="section-number-4">3.3.1</span> Mutable Data</h4>
<div class="outline-text-4" id="text-3-3-1">
<p>
These are the data associated with User type, which are mutable
</p>

<ul class="org-ul">
<li>Name</li>
<li>Email</li>
<li>Role</li>
</ul>
</div>
</div>


<div id="outline-container-orgheadline14" class="outline-4">
<h4 id="orgheadline14"><span class="section-number-4">3.3.2</span> Definition</h4>
<div class="outline-text-4" id="text-3-3-2">
<div class="org-src-container">

<pre class="src src-python">class User():
    
    name = None
    email = None
    role = None
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline17" class="outline-4">
<h4 id="orgheadline17"><span class="section-number-4">3.3.3</span> Constructor</h4>
<div class="outline-text-4" id="text-3-3-3">
</div><ol class="org-ol"><li><a id="orgheadline15"></a>Implementation<br  /><div class="outline-text-5" id="text-3-3-3-1">
<p>
Signature of the constructor of <code>User</code> is as follows:
</p>

<pre class="example">
usr = User(name=&lt;object of Name&gt;, email=&lt;object of Email&gt;, 
          role=[&lt;object of Role&gt;, &lt;object of Role&gt; ...])
</pre>

<div class="org-src-container">

<pre class="src src-python">    def __init__(self,name,email,role):
        
            self.set_email(email)
            self.set_name(name)
            self.set_role(role)
</pre>
</div>
</div></li>


<li><a id="orgheadline16"></a>Test the constructor<br  /><div class="outline-text-5" id="text-3-3-3-2">
<div class="org-src-container">

<pre class="src src-python">class TestUser(TestCase):
    TESTING = True
    

    def test_user_creation(self):
        print "test_user_creation"
        new_user = User(Name("John"),Email("John@gmail.com"),Role.admin)
        # correct email
        self.assertEqual(new_user.email.value, "John@gmail.com")
        self.assertEqual(new_user.name.value, "John")
        self.assertEqual(new_user.role.value, "admin")
        # incorrect email
        self.assertRaises(TypeError,User,(Name("John"),Email("John@gmail.com"),Role.admin))
</pre>
</div>
</div></li></ol>
</div>


<div id="outline-container-orgheadline29" class="outline-4">
<h4 id="orgheadline29"><span class="section-number-4">3.3.4</span> Functions</h4>
<div class="outline-text-4" id="text-3-3-4">
</div><ol class="org-ol"><li><a id="orgheadline19"></a>setEmail<br  /><ol class="org-ol"><li><a id="orgheadline18"></a>Implementaion<br  /><div class="outline-text-6" id="text-3-3-4-1-1">
<div class="org-src-container">

<pre class="src src-python">    def set_email(self, email):
        if isinstance(email,Email):
            self.email = email
        else:
            raise TypeError('Invalid object type for email')
</pre>
</div>
</div></li></ol></li>


<li><a id="orgheadline21"></a>setName<br  /><ol class="org-ol"><li><a id="orgheadline20"></a>Implementation<br  /><div class="outline-text-6" id="text-3-3-4-2-1">
<div class="org-src-container">

<pre class="src src-python">    def set_name(self, name):
        if isinstance(name,Name):
            self.name = name
        else:
            raise TypeError('Invalid object type for name')
</pre>
</div>
</div></li></ol></li>

<li><a id="orgheadline23"></a>setRole<br  /><ol class="org-ol"><li><a id="orgheadline22"></a>Implementation<br  /><div class="outline-text-6" id="text-3-3-4-3-1">
<div class="org-src-container">

<pre class="src src-python">    def set_role(self, role):
        if isinstance(role,Role):
            self.role = role
        else:
            raise TypeError('Invalid object type for role')
</pre>
</div>
</div></li></ol></li>

<li><a id="orgheadline25"></a>getRole<br  /><ol class="org-ol"><li><a id="orgheadline24"></a>Implementation<br  /><div class="outline-text-6" id="text-3-3-4-4-1">
<div class="org-src-container">

<pre class="src src-python">    def get_role(self):
        return self.role
</pre>
</div>
</div></li></ol></li>

<li><a id="orgheadline26"></a>getEmail<br  /><div class="outline-text-5" id="text-3-3-4-5">
<div class="org-src-container">

<pre class="src src-python">   def get_email(self):
       return self.email
</pre>
</div>
</div></li>

<li><a id="orgheadline27"></a>getName<br  /><div class="outline-text-5" id="text-3-3-4-6">
<div class="org-src-container">

<pre class="src src-python">    def get_name(self):
        return self.name
</pre>
</div>
</div></li>

<li><a id="orgheadline28"></a>toClient<br  /><div class="outline-text-5" id="text-3-3-4-7">
<div class="org-src-container">

<pre class="src src-python">    def to_client(self):
        return {
            'name': self.name.to_client(),
            'email': self.email.to_client(),
            'role': self.role.to_client()
        }
</pre>
</div>
</div></li></ol>
</div>
</div>




<div id="outline-container-orgheadline44" class="outline-3">
<h3 id="orgheadline44"><span class="section-number-3">3.4</span> Role</h3>
<div class="outline-text-3" id="text-3-4">
</div><div id="outline-container-orgheadline31" class="outline-4">
<h4 id="orgheadline31"><span class="section-number-4">3.4.1</span> Introduction</h4>
<div class="outline-text-4" id="text-3-4-1">
<p>
A Role has got certain privileges.
</p>

<p>
Different types of roles are:
</p>
<dl class="org-dl">
<dt>Admin</dt><dd>An admin is an user who can add and modify users and delete the
 users who are not in session.    
An Admin can delete another admin who is not in session.
An Admin cannot delete himself because he is in session.</dd>

<dt>User</dt><dd>A User is a user who can view all other users and can modify himself.</dd>
</dl>
</div>
</div>


<div id="outline-container-orgheadline32" class="outline-4">
<h4 id="orgheadline32"><span class="section-number-4">3.4.2</span> Mutable Data</h4>
<div class="outline-text-4" id="text-3-4-2">
<p>
These are the data associated with Role type, which are mutable
</p>

<ul class="org-ul">
<li>value
Of string type and can contain values admin or user.</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline33" class="outline-4">
<h4 id="orgheadline33"><span class="section-number-4">3.4.3</span> Definition</h4>
<div class="outline-text-4" id="text-3-4-3">
<div class="org-src-container">

<pre class="src src-python">class Role():
    
    value = None
    roles = ['admin','user']
    admin = None
    user = None
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline34" class="outline-4">
<h4 id="orgheadline34"><span class="section-number-4">3.4.4</span> Constructor</h4>
<div class="outline-text-4" id="text-3-4-4">
<p>
The signature of Role is defined as follows
</p>
<pre class="example">
role = Role(name=&lt;Object of Name&gt;)
</pre>

<div class="org-src-container">

<pre class="src src-python">    def __init__(self, value):
        self.set_role(value)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline35" class="outline-4">
<h4 id="orgheadline35"><span class="section-number-4">3.4.5</span> Test Constructor</h4>
<div class="outline-text-4" id="text-3-4-5">
<div class="org-src-container">

<pre class="src src-python">class TestRole(TestCase):
    TESTING = True
    

    def test_role_creation(self):
        print "test_role_construtor"
        new_role = Name("admin")
        # correct name
        self.assertEqual(new_role.value, "admin")
        # incorrect name
        self.assertRaises(TypeError, Name, "123dasd")
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline43" class="outline-4">
<h4 id="orgheadline43"><span class="section-number-4">3.4.6</span> Functions</h4>
<div class="outline-text-4" id="text-3-4-6">
</div><ol class="org-ol"><li><a id="orgheadline38"></a>setRole<br  /><ol class="org-ol"><li><a id="orgheadline37"></a>Implementation<br  /><div class="outline-text-6" id="text-3-4-6-1-1">
<div class="org-src-container">

<pre class="src src-python">    def set_role(self, name):
        if name not in Role.roles:
            raise TypeError("Invalid role type")
        else:
            self.value = name
</pre>
</div>
</div>

<ol class="org-ol"><li><a id="orgheadline36"></a>Test_set_role<br  /><div class="outline-text-7" id="text-3-4-6-1-1-1">
<div class="org-src-container">

<pre class="src src-python">    def test_role_set_name(self):
        print "test_role_set_name"
</pre>
</div>
</div></li></ol></li></ol></li>


<li><a id="orgheadline41"></a>getAllRoles<br  /><ol class="org-ol"><li><a id="orgheadline39"></a>Implementation<br  /><div class="outline-text-6" id="text-3-4-6-2-1">
<div class="org-src-container">

<pre class="src src-python">    @staticmethod
    def get_all_roles():
        return Role.roles
</pre>
</div>
</div></li>


<li><a id="orgheadline40"></a>Test getAll: Nil &#x2013;&gt; set[Role]<br  /><div class="outline-text-6" id="text-3-4-6-2-2">
<div class="org-src-container">

<pre class="src src-python">   def test_role_get_all(self):
       print "test_role_get_all"
</pre>
</div>
</div></li></ol></li>


<li><a id="orgheadline42"></a>to_client<br  /><div class="outline-text-5" id="text-3-4-6-3">
<div class="org-src-container">

<pre class="src src-python">    def to_client(self):
        return self.value
Role.admin = Role('admin')
Role.user = Role('user')
</pre>
</div>
</div></li></ol>
</div>
</div>

<div id="outline-container-orgheadline52" class="outline-3">
<h3 id="orgheadline52"><span class="section-number-3">3.5</span> Session</h3>
<div class="outline-text-3" id="text-3-5">
</div><div id="outline-container-orgheadline45" class="outline-4">
<h4 id="orgheadline45"><span class="section-number-4">3.5.1</span> Introduction</h4>
<div class="outline-text-4" id="text-3-5-1">
<p>
Every user gets associated with a session on logging in.
</p>
</div>
</div>

<div id="outline-container-orgheadline46" class="outline-4">
<h4 id="orgheadline46"><span class="section-number-4">3.5.2</span> Mutable Data</h4>
<div class="outline-text-4" id="text-3-5-2">
<p>
The data associated with Session type, which are mutable
</p>

<dl class="org-dl">
<dt>User</dt><dd>A User object is associated with each session object.</dd>
</dl>
</div>
</div>

<div id="outline-container-orgheadline47" class="outline-4">
<h4 id="orgheadline47"><span class="section-number-4">3.5.3</span> Definition</h4>
<div class="outline-text-4" id="text-3-5-3">
<div class="org-src-container">

<pre class="src src-python">class Session():
    
    usr = None
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline48" class="outline-4">
<h4 id="orgheadline48"><span class="section-number-4">3.5.4</span> Constructor</h4>
<div class="outline-text-4" id="text-3-5-4">
<p>
The signature of Session is defined as follows
</p>
<pre class="example">
session = Session(user)
</pre>

<div class="org-src-container">

<pre class="src src-python">    def __init__(self,user):
        self.usr = user
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline51" class="outline-4">
<h4 id="orgheadline51"><span class="section-number-4">3.5.5</span> Functions</h4>
<div class="outline-text-4" id="text-3-5-5">
</div><ol class="org-ol"><li><a id="orgheadline49"></a>get_user<br  /><div class="outline-text-5" id="text-3-5-5-1">
<div class="org-src-container">

<pre class="src src-python">    def get_user(self):
        return self.usr
</pre>
</div>
</div></li>

<li><a id="orgheadline50"></a>set_user<br  /><div class="outline-text-5" id="text-3-5-5-2">
<div class="org-src-container">

<pre class="src src-python">    def set_user(self,user):
        if isinstance(user,User) or user == None:
            self.usr = user
        else:
            raise TypeError('Invalid User type')
</pre>
</div>
</div></li></ol>
</div>
</div>


<div id="outline-container-orgheadline81" class="outline-3">
<h3 id="orgheadline81"><span class="section-number-3">3.6</span> WebSystem</h3>
<div class="outline-text-3" id="text-3-6">
</div><div id="outline-container-orgheadline53" class="outline-4">
<h4 id="orgheadline53"><span class="section-number-4">3.6.1</span> Introduction</h4>
<div class="outline-text-4" id="text-3-6-1">
<p>
A WebSystem is the class that performs all the operations on the system.
</p>

<dl class="org-dl">
<dt>User</dt><dd>A User object is associated with each session object.</dd>
</dl>
</div>
</div>

<div id="outline-container-orgheadline54" class="outline-4">
<h4 id="orgheadline54"><span class="section-number-4">3.6.2</span> Mutable Data</h4>
<div class="outline-text-4" id="text-3-6-2">
<p>
These are the data associated with WebSystem type, which are mutable
</p>

<ul class="org-ul">
<li>users[] 
List of registered users.</li>
<li>sessions[]
List of sessions the logged in users are associated with.</li>
<li>system_active
A boolean variable which is assigned true when the system is active
and false when the system is not active.</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline55" class="outline-4">
<h4 id="orgheadline55"><span class="section-number-4">3.6.3</span> Definition</h4>
<div class="outline-text-4" id="text-3-6-3">
<div class="org-src-container">

<pre class="src src-python">class WebSystem():
    
    users = []
    sessions = []
    system_active = False
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline56" class="outline-4">
<h4 id="orgheadline56"><span class="section-number-4">3.6.4</span> Constructor</h4>
<div class="outline-text-4" id="text-3-6-4">
<p>
The signature of WebSystem is defined as follows
</p>
<pre class="example">
role = Role(user)
</pre>

<div class="org-src-container">

<pre class="src src-python">    def __init__(self,name,email):
        if not WebSystem.system_active :
            adminstrator = User(Name(name),Email(email),Role.admin)
            self.users = [adminstrator]            
            WebSystem.system_active = True
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline57" class="outline-4">
<h4 id="orgheadline57"><span class="section-number-4">3.6.5</span> Test Constructor</h4>
<div class="outline-text-4" id="text-3-6-5">
<div class="org-src-container">

<pre class="src src-python">class WebSystem(TestCase):
    TESTING = True

    def test_WebSystem_cretion(self):
        print 'WebSystem creation test'
        system = setUp()
        self.assertEqual(system.users[0].email.value,'shashank@gmail.com')
        system = tearDown(system)
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline80" class="outline-4">
<h4 id="orgheadline80"><span class="section-number-4">3.6.6</span> Functions</h4>
<div class="outline-text-4" id="text-3-6-6">
</div><ol class="org-ol"><li><a id="orgheadline58"></a>admin_check<br  /><div class="outline-text-5" id="text-3-6-6-1">
<p>
A method to check if a given user is an admin, returns true if and admin else false.
</p>
<div class="org-src-container">

<pre class="src src-python">    def admin_check(self,user):
        for us in self.users:
            if us != user:
                if us.role == Role.admin:
                    return True
        return False
</pre>
</div>
</div></li>


<li><a id="orgheadline59"></a>login<br  /><div class="outline-text-5" id="text-3-6-6-2">
<p>
It is a method for a given user to obtain a session.
</p>

<div class="org-src-container">

<pre class="src src-python">    def login(self,user):
        if isinstance(user,User) and user in self.users:
            flag = 0
            for sess in self.sessions:
                if sess.get_user() == user:
                    flag = 1
                    break
            if flag == 0:
                sess = Session (user)
                self.sessions.append(sess)
                return sess 
            else:
                raise ConstraintError("User already in session")
        else:
            raise TypeError('Invalid user')
</pre>
</div>
</div></li>

<li><a id="orgheadline60"></a>test_login<br  /><div class="outline-text-5" id="text-3-6-6-3">
<div class="org-src-container">

<pre class="src src-python">    def test_login(self):
        print 'login test'
        system = setUp()
        us = system.get_user_from_email('shashank@gmail.com')
        sess = system.login(us)
        self.assertEquals(system.sessions,[sess])
        self.assertRaises(ConstraintError,system.login ,system.get_user_from_email('shashank@gmail.com'))
        user = User(Name('sjhdsjsh'),Email('dhfdjh@djhdj.com'),Role.user)
        self.assertRaises(TypeError,system.login,user)
        system.logout(sess)
        tearDown(system)
</pre>
</div>
</div></li>


<li><a id="orgheadline61"></a>logout<br  /><div class="outline-text-5" id="text-3-6-6-4">
<p>
A method to remove the user from session
</p>
<div class="org-src-container">

<pre class="src src-python">    def logout(self,session):
        if isinstance(session,Session):
            session.set_user(None)
            self.sessions.remove(session)
        else:
            raise TypeError('Invalid Session type')
</pre>
</div>
</div></li>

<li><a id="orgheadline62"></a>test_logout<br  /><div class="outline-text-5" id="text-3-6-6-5">
<div class="org-src-container">

<pre class="src src-python">    def test_logout(self):
        print 'logout test'
        system = setUp()
        us = system.get_user_from_email('shashank@gmail.com')
        sess = system.login(us)
        before = len(system.sessions)
        system.logout(sess)
        after = len(system.sessions)
        boo = after == before
        self.assertFalse(boo)
        tearDown(system)
</pre>
</div>
</div></li>


<li><a id="orgheadline63"></a>create_user<br  /><div class="outline-text-5" id="text-3-6-6-6">
<p>
A method to add a user.
</p>
<div class="org-src-container">

<pre class="src src-python">    def create_user(self,session,name,email,role):
        if session.usr.role == Role.admin:
            for user in self.users:
                if user.email.value == email:
                    raise ConstraintError('User alredy exists!')
            newUser = User(Name(name),Email(email),role)
            self.users.append(newUser)
        else:
            raise NotAuthorizedError('Only an admin can create a new user')
</pre>
</div>
</div></li>

<li><a id="orgheadline64"></a>test_create_user<br  /><div class="outline-text-5" id="text-3-6-6-7">
<div class="org-src-container">

<pre class="src src-python">    def test_create_user(self):
        print 'create user test'
        system = setUp()
        us = system.get_user_from_email('shashank@gmail.com')
        sess = system.login(us)
        system.create_user(sess,'srivalya','srivalya@gmail.com',Role.user)
        boo = len(system.users) == 2
        self.assertTrue(boo)
        sess1 = system.login(system.get_user_from_email('srivalya@gmail.com'))
        self.assertRaises(NotAuthorizedError,system.create_user,sess1,'mike','mike@hsbs.com',Role.admin)
        self.assertRaises(ConstraintError,system.create_user,sess,'mike','srivalya@gmail.com',Role.admin)
        system.logout(sess)
        system.logout(sess1)
        tearDown(system)
</pre>
</div>
</div></li>


<li><a id="orgheadline65"></a>delete_user<br  /><div class="outline-text-5" id="text-3-6-6-8">
<p>
A method to delete a user. 
</p>
<ul class="org-ul">
<li>only an admin can delete users who are not in session.</li>
</ul>

<div class="org-src-container">

<pre class="src src-python">    def delete_user(self,session,user):
        if session.usr.role == Role.admin:
            if isinstance (user,User) and user in self.users:
                for sess in self.sessions:
                    if sess.usr == user:
                        raise NotAuthorizedError('user in session')             
                self.users.remove(user)
                del(user)
                return True
            else:
                raise TypeError('Invalid user')
        else:
            raise NotAuthorizedError('You do not have he permission to delete users' )
</pre>
</div>
</div></li>

<li><a id="orgheadline66"></a>test_delete_user<br  /><div class="outline-text-5" id="text-3-6-6-9">
<div class="org-src-container">

<pre class="src src-python">    def test_delete_user(self):
        print 'delete user test'
        system = setUp()
        us = system.get_user_from_email('shashank@gmail.com')
        sess = system.login(us) 
        system.create_user(sess,'srivalya','srivalya@gmail.com',Role.user)
        system.create_user(sess,'messi','messi@gmail.com',Role.admin)
        system.create_user(sess,'neymar','ney@gmail.com',Role.user)
        system.create_user(sess,'barca','barca@barca.com',Role.user)
        sess1 = system.login(system.get_user_from_email('srivalya@gmail.com'))
        system.delete_user(sess,system.get_user_from_email('ney@gmail.com'))
        boo = len(system.users) == 4
        self.assertTrue(boo)
        self.assertRaises(NotAuthorizedError,system.delete_user,sess,system.get_user_from_email('srivalya@gmail.com'))
        self.assertRaises(NotAuthorizedError,system.delete_user,sess1,system.get_user_from_email('barca@barca.com'))
        system.delete_user(sess,system.get_user_from_email('messi@gmail.com'))
        self.assertTrue(len(system.users) == 3)
        system.logout(sess)
        system.logout(sess1)
        tearDown(system)
</pre>
</div>
</div></li>


<li><a id="orgheadline67"></a>update_role<br  /><div class="outline-text-5" id="text-3-6-6-10">
<p>
A method to update the role of the given user.
</p>
<ul class="org-ul">
<li>If role of given user is 'user' it gets upgraded to admin.</li>
<li>If role of given user is 'admin' it gets downgraded to user.</li>
</ul>
<div class="org-src-container">

<pre class="src src-python">    def update_role(self,session,user):
        if session.usr.role == Role.admin:
            if isinstance (user,User) and user in self.users:
                if user.role == Role.user :
                    user.set_role(Role.admin)
                elif user.role == Role.admin: 
                    if user == session.usr and self.admin_check(user) == True:
                        user.set_role(Role.user)
                    else:
                        raise NotAuthorizedError('Operation not authorized')
                
            else:
                raise TypeError('Invalid User type')
        else:
            raise  NotAuthorizedError('Operation not authorized')
</pre>
</div>
</div></li>

<li><a id="orgheadline68"></a>test_update_role<br  /><div class="outline-text-5" id="text-3-6-6-11">
<div class="org-src-container">

<pre class="src src-python">    def test_update_role(self):
        print 'test update role'
        system = setUp()
        us = system.get_user_from_email('shashank@gmail.com')
        sess = system.login(us)
        system.create_user(sess,'srivalya','srivalya@gmail.com',Role.user)
        system.create_user(sess,'barca','barca@barca.com',Role.user)
        sess1 = system.login(system.get_user_from_email('srivalya@gmail.com'))
        system.update_role(sess,system.get_user_from_email('srivalya@gmail.com'))
        self.assertTrue(system.get_user_from_email('srivalya@gmail.com').role == Role.admin)
        sess2 = system.login(system.get_user_from_email('barca@barca.com'))
        self.assertRaises(NotAuthorizedError,system.update_role,sess,system.get_user_from_email('srivalya@gmail.com'))
        self.assertRaises(NotAuthorizedError,system.update_role,sess2,system.get_user_from_email('barca@barca.com'))
        system.update_role(sess1,system.get_user_from_email('srivalya@gmail.com'))
        self.assertTrue(system.get_user_from_email('srivalya@gmail.com').role == Role.user)
        system.logout(sess)
        system.logout(sess1)
        system.logout(sess2)
        tearDown(system)
</pre>
</div>
</div></li>


<li><a id="orgheadline69"></a>update_name<br  /><div class="outline-text-5" id="text-3-6-6-12">
<div class="org-src-container">

<pre class="src src-python">    def update_name(self,session,user,name):
        if session.usr.role == Role.admin :
            if isinstance (user,User) and user in self.users :
                user.set_name(name)
            else:
                raise TypeError('Invalid Email Type')
        elif session.usr.role == Role.user :
            if isinstance (user,User) and user in self.users and user == session.usr:
                user.set_name(name)
            else:
                raise NotAuthorizedError('Only an admin can change the names of other users')
        else:
            raise TypeError('Invalid role type')
</pre>
</div>
</div></li>

<li><a id="orgheadline70"></a>test_update_name<br  /><div class="outline-text-5" id="text-3-6-6-13">
<div class="org-src-container">

<pre class="src src-python">    def test_update_name(self):
        print 'update name test'
        system = setUp()
        sess = system.login(system.get_user_from_email('shashank@gmail.com'))
        system.create_user(sess,'srivalya','srivalya@gmail.com',Role.user)
        system.create_user(sess,'barca','barca@barca.com',Role.user)
        system.update_name(sess,system.get_user_from_email('srivalya@gmail.com'),Name('sri'))
        self.assertTrue(system.get_user_from_email('srivalya@gmail.com').name.value == 'sri')
        sess1 = system.login(system.get_user_from_email('barca@barca.com'))
        self.assertRaises(NotAuthorizedError,system.update_name,sess1,system.get_user_from_email('shashank@gmail.com'),Name('SV'))
        system.update_name(sess1,system.get_user_from_email('barca@barca.com'),Name('barcelona'))
        self.assertTrue(system.get_user_from_email('barca@barca.com').name.value == 'barcelona')
        system.logout(sess)
        system.logout(sess1)
        tearDown(system)
</pre>
</div>
</div></li>


<li><a id="orgheadline71"></a>update_email<br  /><div class="outline-text-5" id="text-3-6-6-14">
<p>
A method to update email of a user.
</p>
<ul class="org-ul">
<li>An admin can update email of any user and his own.</li>
<li>A user also has the privilege to update their own email</li>
<li>A email will be updated only if it's unique.</li>
</ul>
<div class="org-src-container">

<pre class="src src-python">    def update_email(self,session,user,email):
            if session.usr.role == Role.admin :
                if isinstance (email,Email) and user in self.users :
                    user.set_email(email)
                else:
                    raise TypeError('Invalid User type')          
            elif session.usr.role == Role.user :
                if isinstance (email,Email) and user in self.users and user == session.usr:
                    user.set_email(email)
                else:
                    raise NotAuthorizedError('Only an admin can change the names of other users')
            else:
                raise TypeError('Invalid role type')
</pre>
</div>
</div></li>

<li><a id="orgheadline72"></a>test_update_email<br  /><div class="outline-text-5" id="text-3-6-6-15">
<div class="org-src-container">

<pre class="src src-python">    def test_update_email(self):
        print 'test update email'
        system = setUp()
        sess = system.login(system.get_user_from_email('shashank@gmail.com'))
        system.create_user(sess,'srivalya','srivalya@gmail.com',Role.user)
        system.create_user(sess,'barca','barca@barca.com',Role.user)
        system.update_email(sess,system.get_user_from_email('srivalya@gmail.com'),Email('srivalya12@gmail.com'))
        self.assertTrue(system.get_user_from_email('srivalya12@gmail.com').email.value == 'srivalya12@gmail.com')
        sess1 = system.login(system.get_user_from_email('barca@barca.com'))
        self.assertRaises(NotAuthorizedError,system.update_email,sess1,system.get_user_from_email('shashank@gmail.com'),Email('shashankviswanadha@gmail.com'))
        system.update_email(sess1,system.get_user_from_email('barca@barca.com'),Email('barcelona@barca.com'))
        self.assertTrue(system.get_user_from_email('barcelona@barca.com').email.value == 'barcelona@barca.com')
        system.logout(sess)
        system.logout(sess1)
        tearDown(system)
</pre>
</div>
</div></li>


<li><a id="orgheadline73"></a>search_users<br  /><div class="outline-text-5" id="text-3-6-6-16">
<p>
Returns a list of users either with same email,name or role.
</p>

<div class="org-src-container">

<pre class="src src-python">    def search_users(self,session,**kwargs):
        if session in self.sessions:
            search = []
            for key,value in kwargs.iteritems():
                if key == 'name':
                    c = 0
                    for user in self.users:
                        if user.name.value == value:
                            search.append(user)
                            c = 1
                    if c == 0:
                        raise ConstraintError('Name not found')
                
                if key == 'email':
                    c = 0
                    for user in self.users:
                        if user.email.value == value:
                            search.append(user)
                            c = 1
                            break
                    if c == 0:
                        raise ConstraintError('Email not found')
                
                if key == 'role':
                    c = 0
                    for user in self.users:
                        if user.role == value:
                            search.append(user)
                            c = 1
                    if c == 0:
                        raise ConstraintError('role not found')
            if search == []:
                return False
            return search
        raise ConstraintError('Session not found')
</pre>
</div>
</div></li>

<li><a id="orgheadline74"></a>test_search_users<br  /><div class="outline-text-5" id="text-3-6-6-17">
<div class="org-src-container">

<pre class="src src-"eval">"eval no"body
</pre>
</div>
</div></li>


<li><a id="orgheadline75"></a>show_users<br  /><div class="outline-text-5" id="text-3-6-6-18">
<p>
Returns the list of registered users.
</p>
<div class="org-src-container">

<pre class="src src-python">    def show_users(self):
        return self.users
</pre>
</div>
</div></li>

<li><a id="orgheadline76"></a>test_show_users<br  /><div class="outline-text-5" id="text-3-6-6-19">
<p>
Tests :
</p>
<ul class="org-ul">
<li>3 users are registered and length of user's list is checked.</li>
</ul>
<div class="org-src-container">

<pre class="src src-python">    def test_show_users(self):
        print 'test show users'
        system = setUp()
        sess = system.login(system.get_user_from_email('shashank@gmail.com'))
        system.create_user(sess,'messi','messi@gmail.com',Role.user)
        system.create_user(sess,'barca','barca@barca.com',Role.user)
        self.assertTrue(len(system.show_users()) == 3)
        system.logout(sess)
        tearDown(system)
</pre>
</div>
</div></li>


<li><a id="orgheadline77"></a>get_sessions<br  /><div class="outline-text-5" id="text-3-6-6-20">
<p>
Returns the session list of the system.
</p>
<div class="org-src-container">

<pre class="src src-python">    def get_sessions(self):
        return self.sessions
</pre>
</div>
</div></li>

<li><a id="orgheadline78"></a>test_get_sessions<br  /><div class="outline-text-5" id="text-3-6-6-21">
<p>
Tests
</p>
<ul class="org-ul">
<li>3 users are logged in, and length of the session's list is checked.</li>
</ul>
<div class="org-src-container">

<pre class="src src-python">    def test_get_sessions(self):
        print 'test get sessions'
        system = setUp()
        sess = system.login(system.get_user_from_email('shashank@gmail.com'))
        system.create_user(sess,'messi','messi@gmail.com',Role.user)
        system.create_user(sess,'barca','barca@barca.com',Role.user)
        sess1 = system.login(system.get_user_from_email('messi@gmail.com'))
        sess2 = system.login(system.get_user_from_email('barca@barca.com'))
        self.assertTrue(len(system.get_sessions()) == 3) 
        system.logout(sess)
        system.logout(sess1)
        system.logout(sess2)
        tearDown(system)
</pre>
</div>
</div></li>


<li><a id="orgheadline79"></a>get_user_from_email<br  /><div class="outline-text-5" id="text-3-6-6-22">
<div class="org-src-container">

<pre class="src src-python">    def get_user_from_email(self,email):
        for user in self.users:
            if user.get_email().value == email:
                return user
        return False
</pre>
</div>
</div></li></ol>
</div>
</div>

<div id="outline-container-orgheadline82" class="outline-3">
<h3 id="orgheadline82"><span class="section-number-3">3.7</span> setUp and tearDown</h3>
<div class="outline-text-3" id="text-3-7">
<div class="org-src-container">

<pre class="src src-python">def setUp():
    
    system = WebSystem('shashank','shashank@gmail.com')
    return system

def tearDown(system):

    system.users = []
    system.sessions = []
    WebSystem.system_active = False
    return system
</pre>
</div>
</div>
</div>
</div>



<div id="outline-container-orgheadline84" class="outline-2">
<h2 id="orgheadline84"><span class="section-number-2">4</span> Run Test Cases</h2>
<div class="outline-text-2" id="text-4">
<div class="org-src-container">

<pre class="src src-python">if __name__ == '__main__':
    unittest.main()
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: <span class="timestamp-wrapper"><span class="timestamp">[2016-05-11 Wed]</span></span></p>
<p class="author">Author: VLEAD</p>
<p class="date">Created: 2016-06-03 Fri 09:27</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
